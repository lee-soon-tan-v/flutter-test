<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="UTF-8">
  <meta name="viewport" content="width=device-width, initial-scale=1.0">
  <title>All File Input Types</title>
  <style>
    body {
      font-family: Arial, sans-serif;
      background: #f4f6f8;
      display: flex;
      flex-direction: column;
      align-items: center;
      padding: 20px;
    }
    h2 { margin-top: 30px; }
    .input-container {
      background: #fff;
      padding: 15px;
      margin: 10px 0;
      border-radius: 8px;
      width: 100%;
      max-width: 400px;
      box-shadow: 0 4px 8px rgba(0,0,0,0.1);
    }
    input { width: 100%; padding: 10px; margin-top: 5px; }
  </style>
</head>
<body>

  <a href="#/">Home</a>
  <a href="#/about">About</a>
  <a href="#/profile">Profile</a>
  <section id="app"></section>

  
  <h1>File Input Types Test</h1>

  <!-- Single file -->
  <div class="input-container">
    <h2>Single File</h2>
    <input type="file" name="single-file">
  </div>

  <!-- Multiple files -->
  <div class="input-container">
    <h2>Multiple Files</h2>
    <input type="file" name="multiple-files" multiple>
  </div>

  <!-- Images only -->
  <div class="input-container">
    <h2>Images Only</h2>
    <input type="file" name="images-only" accept="image/*" multiple>
  </div>

  <!-- Videos only -->
  <div class="input-container">
    <h2>Videos Only</h2>
    <input type="file" name="videos-only" accept="video/*" multiple>
  </div>

  <!-- PDFs only -->
  <div class="input-container">
    <h2>PDF Only</h2>
    <input type="file" name="pdf-only" accept=".pdf">
  </div>

  <!-- Images + camera -->
  <div class="input-container">
    <h2>Camera Capture (Image)</h2>
    <input type="file" name="camera-image" accept="image/*" capture="camera">
  </div>

  <!-- Video capture -->
  <div class="input-container">
    <h2>Camera Capture (Video)</h2>
    <input type="file" name="camera-video" accept="video/*" capture="camcorder">
  </div>

  <!-- Audio capture -->
  <div class="input-container">
    <h2>Microphone Capture (Audio)</h2>
    <input type="file" name="audio" accept="audio/*" capture="microphone">
  </div>

  <!-- Multiple types -->
  <div class="input-container">
    <h2>Custom File Types</h2>
    <input type="file" name="custom-types" accept=".jpg,.png,.pdf,.txt" multiple>
  </div>

  <!-- Folder selection (desktop only) -->
  <div class="input-container">
    <h2>Folder Selection (Desktop Only)</h2>
    <input type="file" name="folder" webkitdirectory>
  </div>

	
  <label for="title">Title:</label>
  <input type="text" id="title" name="title"><br><br>
  <label for="content">content:</label>
  <input type="text" id="content" name="content"><br><br>
  <label for="okText">okText:</label>
  <input type="text" id="okText" name="okText"><br><br>
  <label for="cancelText">cancelText:</label>
  <input type="text" id="cancelText" name="cancelText"><br><br>
  <button onclick="testDialog()">test dialog</button>
	
	<br><br>
  <button onclick="scanBarcode()">barcode</button>
  <script>
	function testDialog(){
		send(JSON.stringify({
			'action': 'confirm-dialog',
			'title': document.getElementById('title').value ?? null,
			'content': document.getElementById('content').value ?? null,
			'okText': document.getElementById('okText').value ?? null,
			'cancelText': document.getElementById('cancelText').value ?? null,
			'data': 'some123'
		}));
	}

	  function scanBarcode(){

		send(JSON.stringify({
			'action': 'scan-barcode',
		}));
	  }

	  
    // Message send to Flutter
    function send(msg){
      try {
	    sendToFlutter.postMessage(msg);
      } catch (e) {
        console.warn("sendToFlutter not available:", e);
      }
    }

    // Message received from Flutter
  function sendToWebView(msg) {
    alert("Flutter replied: " + JSON.stringify(msg));

	  if(typeof msg === 'object'){
		if(msg?.action === 'confirm-dialog' && msg?.data === 'exit-app'){
		  	if(msg?.confirm) {
				send(JSON.stringify({'action': 'exit'})); 
			}else {
				history.pushState({ page: '/' }, '', `#/`);
			}
		}
  	}
  
    console.log("Flutter replied:", msg);
  }







	  
  



	let currentHistory = [];
	
  
    const app = document.getElementById('app');
    let currentCleanup = null;

    function home() {
      app.innerHTML = '<h2>Home</h2>';
      return () => {};
    }

    function about() {
      app.innerHTML = '<h2>About</h2>';
      return () => {};
    }

    function profile() {
      app.innerHTML = '<h2>Profile</h2>';
      return () => {};
    }


    const routes = {
      '/': home,
      '/about': about,
      '/profile': profile,
    };

    function render(path) {
      if (currentCleanup) currentCleanup();

      const route = routes[path];
      if (!route) {
        app.innerHTML = '<h2>404</h2>';
        return;
      }

      currentCleanup = route();
    }

    function navigate(path) { 
		currentHistory.push(path);
		
		switch(path){
			case '/profile':
				history.pushState({ page: path }, '', `#${path}`);
			break;
			case '/about':
				history.pushState({ page: path }, '', `#${path}`);
			break;
			case '/':
				history.replaceState({ page: '/' }, '', '#/');
			break;
				console.log('path nt found: ' + currentPath)
			default:
			
		}
	
		render(path);
    }

    document.addEventListener('click', (e) => {
      const a = e.target.closest('a[href^="#/"]');
      if (!a) return;

      e.preventDefault();
      navigate(a.getAttribute('href').slice(1));
    });


	
	
    window.addEventListener('popstate', (event) => {
		//if(currentHistory.length === 1){alert('a')}
		// Check if previous page is Home
		if(currentHistory.at(-1) === '/' || !currentHistory.at(-1)){
			//let result = confirm('exit');
			let result = send(JSON.stringify({
				'action': 'confirm-dialog',
				'title': 'Exit Alert',
				'content': 'Do you want to exit?',
				'okText': 'YES',
				'cancelText': 'NO',
				'data': 'exit-app'
			}));
			// if(result) {
			// 	console.log('exit');
			// 	send(JSON.stringify({'action': 'exit'})); 
			// }else {
			// 	history.pushState({ page: '/' }, '', `#/`);
			// }
		}else{
			currentHistory.pop();
			// Render new page
			console.log('render')
			render(currentHistory.at(-1));
		}
	
    });

	
	// Initial load
    render('/');
	history.pushState({ page: '/' }, '', `#/`);
	currentHistory.push('/');
	

  </script>
  
  
</body>
</html>
